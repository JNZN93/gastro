<div class="customer-order-public">
  <!-- Header -->
  <header class="header">
    <div class="container">
      <div class="logo">
        <img src="/assets/logo.webp" alt="Logo" class="logo-img">
        <h1>Bestellformular</h1>
      </div>
      <button class="back-btn" (click)="goBack()">
        <img src="/assets/back.png" alt="Zur√ºck" class="back-icon">
        Zur√ºck
      </button>
    </div>
  </header>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-container">
    <div class="loading-spinner"></div>
    <p>Lade Bestelldaten...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error && !isLoading" class="error-container">
    <div class="error-message">
      <h2>Fehler</h2>
      <p>{{ error }}</p>
      <button class="retry-btn" (click)="loadCustomerData()">Erneut versuchen</button>
    </div>
  </div>

  <!-- Success Message -->
  <div *ngIf="successMessage" class="success-container">
    <div class="success-message">
      <h2>Bestellung erfolgreich!</h2>
      <p>{{ successMessage }}</p>
      <p>Sie werden in K√ºrze weitergeleitet...</p>
    </div>
  </div>

  <!-- Main Content -->
  <div *ngIf="!isLoading && !error && !successMessage" class="main-content">
    <div class="container">
      
      <!-- Customer Info -->
      <div class="customer-info">
        <h2>Kundendaten</h2>
        <div class="customer-details">
          <div class="detail-item">
            <strong>Firma:</strong> {{ customer?.last_name_company }}
          </div>
          <div class="detail-item">
            <strong>Kundennummer:</strong> {{ customer?.customer_number }}
          </div>
          <div class="detail-item" *ngIf="customer?.name_addition">
            <strong>Zusatz:</strong> {{ customer?.name_addition }}
          </div>
        </div>
      </div>

      <!-- Product Catalog -->
      <div class="product-catalog">
        <h2>Verf√ºgbare Artikel</h2>
        <p class="catalog-description">
          W√§hlen Sie die gew√ºnschten Artikel aus und geben Sie die Menge ein.
        </p>
        
        <div class="products-grid">
          <div *ngFor="let article of customerArticlePrices" class="product-card">
            <div class="product-info">
              <h3 class="product-name">{{ article.article_text }}</h3>
              <p class="product-number">Art.-Nr.: {{ article.article_number || article.product_id }}</p>
              <div class="price-info">
                <span class="price">‚Ç¨{{ article.unit_price_net?.toFixed(2) }}</span>
                <span class="price-unit">pro St√ºck</span>
              </div>
            </div>
            
            <div class="quantity-input">
              <label for="quantity-{{ article.product_id }}">Menge:</label>
              <input 
                type="number" 
                id="quantity-{{ article.product_id }}"
                [(ngModel)]="article.tempQuantity"
                min="1"
                placeholder="0"
                class="quantity-field"
              >
              <button 
                class="add-btn"
                (click)="addToOrder(article)"
                [disabled]="!article.tempQuantity || article.tempQuantity <= 0"
              >
                Hinzuf√ºgen
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Order Summary -->
      <div class="order-summary" *ngIf="orderItems.length > 0">
        <h2>Ihre Bestellung</h2>
        
        <div class="order-items">
          <div *ngFor="let item of orderItems; let i = index" class="order-item">
            <div class="item-info">
              <h4>{{ item.article_text }}</h4>
              <p class="item-number">Art.-Nr.: {{ item.article_number }}</p>
            </div>
            
            <div class="item-quantity">
              <label for="order-quantity-{{ i }}">Menge:</label>
              <input 
                type="number" 
                id="order-quantity-{{ i }}"
                [value]="item.quantity"
                (change)="updateQuantity(i, $event)"
                min="1"
                class="quantity-field"
              >
            </div>
            
            <div class="item-price">
              <span class="unit-price">‚Ç¨{{ item.unit_price?.toFixed(2) }} √ó {{ item.quantity }}</span>
              <span class="total-price">‚Ç¨{{ item.total_price?.toFixed(2) }}</span>
            </div>
            
            <button class="remove-btn" (click)="removeFromOrder(i)">
              <img src="/assets/back.png" alt="Entfernen" class="remove-icon">
            </button>
          </div>
        </div>

        <div class="order-total">
          <h3>Gesamtpreis: ‚Ç¨{{ getOrderTotal().toFixed(2) }}</h3>
        </div>

        <div class="order-actions">
          <button 
            class="submit-btn"
            (click)="submitOrder()"
            [disabled]="isSubmitting"
          >
            <span *ngIf="!isSubmitting">Bestellung absenden</span>
            <span *ngIf="isSubmitting">Wird gesendet...</span>
          </button>
        </div>
      </div>

      <!-- Empty State -->
      <div *ngIf="orderItems.length === 0" class="empty-state">
        <div class="empty-icon">üõí</div>
        <h3>Ihr Warenkorb ist leer</h3>
        <p>F√ºgen Sie Artikel aus dem Katalog hinzu, um eine Bestellung aufzugeben.</p>
      </div>

    </div>
  </div>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <p>&copy; 2024 Gastro Bestellsystem. Alle Rechte vorbehalten.</p>
    </div>
  </footer>
</div>
